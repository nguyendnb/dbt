with source as (

    select

        {{ dbt_utils.star(from=source('sch_miser', 'savings_mvw'), except=['deleted_record', 'update_time', 'update_type', 'az_batch_update']) }}

    from {{ source('sch_miser', 'savings_mvw') }}

),

final as (

    select

        case when s_appl_code = '2' then 'cd' else 's' end as type,
        {{ cast_data_types([
            'az_batch_date',
            's_atm_od_opt_dt',
            's_atmod_cnfrm_dt',
            's_avg_thru_dt',
            's_bdc_dt',
            's_carryover_dt',
            's_check_hold_dt_1',
            's_check_hold_dt_2',
            's_check_hold_dt_3',
            's_check_hold_dt_4',
            's_close_date',
            's_credit_dt_occur',
            's_dbc_od_opt_dt',
            's_dbcod_cnfrm_dt',
            's_dorm_dt',
            's_dt_last_act',
            's_dt_last_addr',
            's_dt_last_br_dep',
            's_dt_last_dep',
            's_dt_last_fm',
            's_dt_last_stmt',
            's_dt_lst_atm_txn',
            's_dt_lst_br_txn',
            's_dt_lst_cct_txn',
            's_dt_lst_ebk_txn',
            's_dt_lst_tbk_txn',
            's_dt_lst_wt_txn',
            's_dt_next_rtchg',
            's_dt_prev_stmt',
            's_first_mat_dt',
            's_guar_start_dt',
            's_guar_thru_dt',
            's_int_pd_thru_dt',
            's_mat_dt_adj',
            's_mat_not_dt',
            's_memo_dt',
            's_mgt_hold_dt',
            's_ms_added_dt',
            's_ms_dissolve_dt',
            's_next_hld_dt',
            's_next_int_dt',
            's_next_int_dt_adj',
            's_opening_dt',
            's_postdated_amt',
            's_prev_mat_dt',
            's_proxy_dt',
            's_tickler_date',
            's_uncol_dt_1',
            's_uncol_dt_2',
            's_uncol_dt_3',
            's_uncol_dt_4',
            's_uncol_dt_5',
            's_uncol_dt_6',
            's_uncol_dt_7',
            's_waive_sc_dt',
            's_warn_flag2_dt'
        ], 'date') }},
        {{ cast_data_types([
            's_1099_corr',
            's_bal_last_stmt',
            's_amt_last_dep',
            's_br_last_dep',
            's_1099c_corr',
            's_1099m_corr',
            's_1099oid_corr',
            's_accrued_int',
            's_accrued_stmt',
            's_acct_bal',
            's_acct_class',
            's_accum_int_amt',
            's_accum_int_freq',
            's_ach_db_ret_rsn',
            's_ach_exc_ntc',
            's_ach_notice_cd',
            's_ach_nsf_ltd',
            's_ach_ret_prv_yr',
            's_ach_ret_ytd',
            's_ach_times_nsf_01',
            's_ach_times_nsf_02',
            's_ach_times_nsf_03',
            's_ach_times_nsf_04',
            's_ach_times_nsf_05',
            's_ach_times_nsf_06',
            's_ach_times_nsf_07',
            's_ach_times_nsf_08',
            's_ach_times_nsf_09',
            's_ach_times_nsf_10',
            's_ach_times_nsf_11',
            's_ach_times_nsf_12',
            's_ach_times_nsf_13',
            's_ad_flag',
            's_addl_dep_ctrl',
            's_agg_bal_int',
            's_agg_bal_sc',
            's_agg_bal_stmt',
            's_agg_hld_int',
            's_agg_hld_sc',
            's_agg_hld_stmt',
            's_alerts',
            's_alt_na_code',
            's_amt_sda_rcv_c',
            's_amt_sda_rcv_d',
            's_amt_sda_snt_c',
            's_amt_sda_snt_d',
            's_appl_code',
            's_assn_nbr',
            's_atm_od_ind',
            's_atm_od_opt_mth',
            's_atm_sc_code',
            's_atm_tot_wd',
            's_atmdbc_xmt_amt',
            's_avgbal_01',
            's_avgbal_02',
            's_avgbal_03',
            's_avgbal_04',
            's_avgbal_05',
            's_avgbal_06',
            's_avgbal_07',
            's_avgbal_08',
            's_avgbal_09',
            's_avgbal_10',
            's_avgbal_11',
            's_avgbal_12',
            's_avgbal_13',
            's_avgbal_14',
            's_bdc_amt',
            's_bonus_amt_pd',
            's_bonus_code',
            's_business_trans',
            's_ca_acct_nbr',
            's_ca_appl_code',
            's_ca_comp_pct',
            's_ca_pk_ind',
            's_calc_bal_code',
            's_calc_bi_trial_bal',
            's_calc_meth',
            's_card_flag',
            's_card_nbr',
            's_card_type',
            's_carryover_amt',
            's_check_hold_amt_1',
            's_check_hold_amt_2',
            's_check_hold_amt_3',
            's_check_hold_amt_4',
            's_chrg_off_seq',
            's_chrg_off_stat',
            's_cjar_code',
            's_ck_cash_wd',
            's_ckhld_today_1',
            's_ckhld_today_2',
            's_ckhld_today_3',
            's_ckhld_today_4',
            's_closed_to_post',
            's_cmt_flag',
            's_cmt_target_bal',
            's_cmt_target_max',
            's_cmt_target_min',
            's_cmt_target_typ',
            's_co_accrint_rem',
            's_co_atm_nbr_wd',
            's_co_atm_tot_wd',
            's_co_gatm_denial',
            's_co_gatm_dep',
            's_co_gatm_inq',
            's_co_gatm_stmt',
            's_co_gatm_tfr_in',
            's_co_gatm_tfr_out',
            's_co_gatm_wd',
            's_co_iatm_denial',
            's_co_iatm_dep',
            's_co_iatm_inq',
            's_co_iatm_stmt',
            's_co_iatm_tfr_in',
            's_co_iatm_tfr_out',
            's_co_iatm_wd',
            's_co_ib_wd',
            's_co_ivr_wd',
            's_co_nbr_wd',
            's_co_nbr_wd_cyc',
            's_co_otc_wd',
            's_co_p2p_dep',
            's_co_p2p_wd',
            's_co_patm_denial',
            's_co_patm_dep',
            's_co_patm_inq',
            's_co_patm_stmt',
            's_co_patm_tfr_in',
            's_co_patm_tfr_out',
            's_co_patm_wd',
            's_co_pos_denial',
            's_co_pos_dep',
            's_co_pos_nbr_wd',
            's_co_pos_tot_wd',
            's_co_pos_wd',
            's_co_satm_denial',
            's_co_satm_dep',
            's_co_satm_inq',
            's_co_satm_stmt',
            's_co_satm_tfr_in',
            's_co_satm_tfr_out',
            's_co_satm_wd',
            's_collat_amt',
            's_collat_code',
            's_comp_ctrl',
            's_compounded_int',
            's_covr_memo_amt',
            's_covr_memo_cash',
            's_covr_memo_cks',
            's_cr_otc_cnt',
            's_credit_code',
            's_credit_comment',
            's_credit_metro',
            's_ctr_exmt_amt',
            's_cus_code',
            's_cus_ctrl',
            's_cus_sc_code',
            's_cus_sc_ctl',
            's_cus_type',
            's_cust_desc_code',
            's_days_od',
            's_days_od_prv_yr',
            's_days_od_ytd',
            's_dbc_od_ind',
            's_dbc_od_opt_mth',
            's_delivery_dflt',
            's_dist_priority',
            's_dr_otc_cnt',
            's_dup_doc_ind',
            's_edelivery',
            's_edi_ctl_code',
            's_employee_code',
            's_exc_adj_amt',
            's_exc_exempt_amt',
            's_excwd_fee_opt',
            's_exist_cust',
            's_exp_1',
            's_exp_2',
            's_exp_3',
            's_exp_4',
            's_exp_5',
            's_exp_6',
            's_exp_alpha_cd_1',
            's_exp_alpha_cd_2',
            's_exp_alpha_cd_3',
            's_exp_alpha_cd_4',
            's_exp_alpha_cd_5',
            's_exp_alpha_cd_6',
            's_exp_amt_1',
            's_exp_amt_2',
            's_exp_amt_3',
            's_exp_amt_4',
            's_exp_amt_5',
            's_exp_amt_6',
            's_exp_num_1',
            's_exp_num_2',
            's_exp_num_3',
            's_exp_num_4',
            's_exp_num_5',
            's_exp_num_6',
            's_exp_rate_1',
            's_exp_rate_2',
            's_exp_rate_3',
            's_exp_rate_4',
            's_exp_rate_5',
            's_exp_rate_6',
            's_fatca_ind',
            's_fatca_tax_pytd',
            's_fatca_tax_ytd',
            's_fatm_feer_cy',
            's_fatm_feer_py',
            's_fdic_line_code',
            's_fiche_code',
            's_flags',
            's_flags_2',
            's_fr_ach_cr_01',
            's_fr_ach_cr_02',
            's_fr_ach_cr_03',
            's_fr_ach_cr_04',
            's_fr_ach_cr_05',
            's_fr_ach_cr_06',
            's_fr_ach_cr_07',
            's_fr_ach_cr_08',
            's_fr_ach_cr_09',
            's_fr_ach_cr_10',
            's_fr_ach_cr_11',
            's_fr_ach_cr_12',
            's_fr_ach_db_orig_01',
            's_fr_ach_db_orig_02',
            's_fr_ach_db_orig_03',
            's_fr_ach_db_orig_04',
            's_fr_ach_db_orig_05',
            's_fr_ach_db_orig_06',
            's_fr_ach_db_orig_07',
            's_fr_ach_db_orig_08',
            's_fr_ach_db_orig_09',
            's_fr_ach_db_orig_10',
            's_fr_ach_db_orig_11',
            's_fr_ach_db_orig_12',
            's_fr_br_dp_01',
            's_fr_br_dp_02',
            's_fr_br_dp_03',
            's_fr_br_dp_04',
            's_fr_br_dp_05',
            's_fr_br_dp_06',
            's_fr_br_dp_07',
            's_fr_br_dp_08',
            's_fr_br_dp_09',
            's_fr_br_dp_10',
            's_fr_br_dp_11',
            's_fr_br_dp_12',
            's_fr_br_wd_01',
            's_fr_br_wd_02',
            's_fr_br_wd_03',
            's_fr_br_wd_04',
            's_fr_br_wd_05',
            's_fr_br_wd_06',
            's_fr_br_wd_07',
            's_fr_br_wd_08',
            's_fr_br_wd_09',
            's_fr_br_wd_10',
            's_fr_br_wd_11',
            's_fr_br_wd_12',
            's_fr_ebk_dp_01',
            's_fr_ebk_dp_02',
            's_fr_ebk_dp_03',
            's_fr_ebk_dp_04',
            's_fr_ebk_dp_05',
            's_fr_ebk_dp_06',
            's_fr_ebk_dp_07',
            's_fr_ebk_dp_08',
            's_fr_ebk_dp_09',
            's_fr_ebk_dp_10',
            's_fr_ebk_dp_11',
            's_fr_ebk_dp_12',
            's_fr_ebk_wd_01',
            's_fr_ebk_wd_02',
            's_fr_ebk_wd_03',
            's_fr_ebk_wd_04',
            's_fr_ebk_wd_05',
            's_fr_ebk_wd_06',
            's_fr_ebk_wd_07',
            's_fr_ebk_wd_08',
            's_fr_ebk_wd_09',
            's_fr_ebk_wd_10',
            's_fr_ebk_wd_11',
            's_fr_ebk_wd_12',
            's_fr_excl_ind',
            's_fr_tbk_dp_01',
            's_fr_tbk_dp_02',
            's_fr_tbk_dp_03',
            's_fr_tbk_dp_04',
            's_fr_tbk_dp_05',
            's_fr_tbk_dp_06',
            's_fr_tbk_dp_07',
            's_fr_tbk_dp_08',
            's_fr_tbk_dp_09',
            's_fr_tbk_dp_10',
            's_fr_tbk_dp_11',
            's_fr_tbk_dp_12',
            's_fr_tbk_wd_01',
            's_fr_tbk_wd_02',
            's_fr_tbk_wd_03',
            's_fr_tbk_wd_04',
            's_fr_tbk_wd_05',
            's_fr_tbk_wd_06',
            's_fr_tbk_wd_07',
            's_fr_tbk_wd_08',
            's_fr_tbk_wd_09',
            's_fr_tbk_wd_10',
            's_fr_tbk_wd_11',
            's_fr_tbk_wd_12',
            's_fr_wt_cr_01',
            's_fr_wt_cr_02',
            's_fr_wt_cr_03',
            's_fr_wt_cr_04',
            's_fr_wt_cr_05',
            's_fr_wt_cr_06',
            's_fr_wt_cr_07',
            's_fr_wt_cr_08',
            's_fr_wt_cr_09',
            's_fr_wt_cr_10',
            's_fr_wt_cr_11',
            's_fr_wt_cr_12',
            's_fr_wt_db_01',
            's_fr_wt_db_02',
            's_fr_wt_db_03',
            's_fr_wt_db_04',
            's_fr_wt_db_05',
            's_fr_wt_db_06',
            's_fr_wt_db_07',
            's_fr_wt_db_08',
            's_fr_wt_db_09',
            's_fr_wt_db_10',
            's_fr_wt_db_11',
            's_fr_wt_db_12',
            's_gatm_denial',
            's_gatm_dep',
            's_gatm_inq',
            's_gatm_stmt',
            's_gatm_tfr_in',
            's_gatm_tfr_out',
            's_gatm_wd',
            's_gift_exp_rem',
            's_gift_inv_code',
            's_grace_code',
            's_grace_ctrl',
            's_grace_i_freq',
            's_grace_i_mbal',
            's_grace_mdep',
            's_guar_expir_rt',
            's_guar_idx',
            's_guar_rate',
            's_guar_type',
            's_hard_holds',
            's_hf_chrg_code',
            's_hf_chrg_today',
            's_hf_cnt_today',
            's_hld_sched',
            's_iatm_denial',
            's_iatm_dep',
            's_iatm_inq',
            's_iatm_stmt',
            's_iatm_tfr_in',
            's_iatm_tfr_out',
            's_iatm_wd',
            's_idx_use_ctrl',
            's_int_accr_ctrl',
            's_int_rate',
            's_intang_tax_code',
            's_ivr_wd',
            's_ki_int_addl_fw',
            's_ki_int_addl_sw',
            's_ki_int_afw_perc',
            's_ki_int_asw_perc',
            's_ki_int_fw_opt',
            's_ki_int_sw_opt',
            's_low_colbal_int',
            's_low_colbal_sc',
            's_ltd_id_recvd',
            's_mail_code',
            's_memo_amt',
            's_memo_cash',
            's_memo_cks',
            's_mgt_hld_amt',
            's_mgt_hold_amt',
            's_min_bal_int_1',
            's_min_bal_int_2',
            's_min_bal_int_3',
            's_min_bal_sc',
            's_min_dep_days',
            's_ms_acct_nbr',
            's_ms_appl_code',
            's_ms_pk_ind',
            's_ms_pk_rate_var',
            's_mtd_atm_txn',
            's_mtd_br_txn',
            's_mtd_cct_txn',
            's_mtd_ebk_txn',
            's_mtd_tbk_txn',
            's_mtd_wt_txn',
            's_multi_int_ind',
            's_nbr_inq',
            's_nbr_res_trans',
            's_nbr_sda_rcv_c',
            's_nbr_sda_rcv_d',
            's_nbr_sda_snt_c',
            's_nbr_sda_snt_d',
            's_nsf_chrg_code',
            's_nsf_chrg_today',
            's_nsf_cnt_today',
            's_od_chrg_code',
            's_oid_code',
            's_oid_exp_freq',
            's_oid_ltd',
            's_oid_prev_ytd',
            's_oid_unearn_int',
            's_oid_ytd',
            's_oid_ytd_int_exp',
            's_p2p_dep',
            's_p2p_wd',
            's_patm_denial',
            's_patm_stmt',
            's_patm_tfr_in',
            's_pb_stmt_ind',
            's_pch_sch_nbr',
            's_pen_net_gross',
            's_penalty_min',
            's_pin_nbr_1',
            's_pin_nbr_2',
            's_pin_nbr_3',
            's_pmt_freq',
            's_pmt_meth',
            's_pnlty_flatfee',
            's_pos_denial',
            's_pos_dep',
            's_pos_tot_wd',
            's_prev_mat_amt',
            's_prev_sc_colbal',
            's_prev_sc_minbal',
            's_prev_ytd_int',
            's_prev_ytd_pen',
            's_prime_var',
            's_prime_var_cd',
            's_prmo_atm_txn',
            's_prmo_br_txn',
            's_prmo_cct_txn',
            's_prmo_ebk_txn',
            's_prmo_tbk_txn',
            's_prmo_wt_txn',
            's_product_code',
            's_profit_eva',
            's_proxy_code',
            's_pt_accr_amt',
            's_purge_bal',
            's_pytd_id_recvd',
            's_pytd_int_dist',
            's_rate_chg_freq',
            's_regdd_flag',
            's_renew_pmt_freq',
            's_renew_rate',
            's_renewal_code',
            's_renewal_conf',
            's_ret_chrg_today',
            's_ret_cnt_today',
            's_rpt_unpaid',
            's_rt_chg_nbr',
            's_rt_chg_rem',
            's_rtn_dpitms_01',
            's_rtn_dpitms_02',
            's_rtn_dpitms_03',
            's_rtn_dpitms_04',
            's_rtn_dpitms_05',
            's_rtn_dpitms_06',
            's_rtn_dpitms_07',
            's_rtn_dpitms_08',
            's_rtn_dpitms_09',
            's_rtn_dpitms_10',
            's_rtn_dpitms_11',
            's_rtn_dpitms_12',
            's_rtn_dpitms_13',
            's_rwd_bill_pay',
            's_rwd_cyc_ind',
            's_satm_denial',
            's_satm_dep',
            's_satm_schg',
            's_satm_schg_amt',
            's_satm_schg_ctl',
            's_satm_stmt',
            's_satm_tfr_in',
            's_satm_tfr_out',
            's_sc_defer',
            's_sched_nbr',
            's_schg_reb_pytd',
            's_schg_reb_ytd',
            's_sda_opt',
            's_sda_rcv_c_opt',
            's_sda_rcv_c_scc',
            's_sda_rcv_d_opt',
            's_sda_rcv_d_scc',
            's_sda_snt_c_opt',
            's_sda_snt_c_scc',
            's_sda_snt_d_opt',
            's_sda_snt_d_scc',
            's_sor_1099_corr',
            's_sor_fatm_fr_cy',
            's_sor_fatm_fr_py',
            's_sor_fw_py',
            's_sor_fw_ytd',
            's_sor_int_py',
            's_sor_int_ytd',
            's_sor_pen_py',
            's_sor_pen_ytd',
            's_sor_sw_py',
            's_sor_sw_ytd',
            's_spec_int_ctrl',
            's_status',
            's_stmt_comb_appl',
            's_stmt_comb_code',
            's_stmt_req_ind',
            's_sub_appl_code',
            's_svc_officer',
            's_tax_id_name',
            's_term_int_paid',
            's_tfr_appl_code',
            's_tfr_fee',
            's_tfr_fee_code',
            's_tfr_price_rate',
            's_tickler_code',
            's_tier_ctrl',
            's_tran_acct',
            's_trlr_flags',
            's_trlr_flags_2',
            's_trust_nbr',
            's_ucf_chrg_code',
            's_ucf_chrg_today',
            's_ucf_cnt_today',
            's_uncol_amt_1',
            's_uncol_amt_2',
            's_uncol_amt_4',
            's_uncol_amt_5',
            's_uncol_amt_6',
            's_uncol_amt_7',
            's_user_alpha_cd_1',
            's_user_alpha_cd_2',
            's_user_alpha_cd_6',
            's_user_amount_1',
            's_user_amount_2',
            's_user_amount_3',
            's_user_amount_4',
            's_user_amount_5',
            's_user_amount_6',
            's_user_number_2',
            's_user_number_4',
            's_user_number_5',
            's_user_number_6',
            's_user_rate_1',
            's_user_rate_2',
            's_user_rate_3',
            's_user_rate_4',
            's_user_rate_5',
            's_user_rate_6',
            's_waive_inq_fee',
            's_wth_net_gross',
            's_wv_paper_fee',
            's_ytd_id_recvd',
            's_ytd_int',
            's_ytd_int_dist',
            's_ytd_penalty',
            's_ytd_rw_paid'
        ], 'double') }},
        {{ cast_data_types([
            's_acct_type',
            's_agent_officer',
            's_agg_days_int',
            's_agg_days_sc',
            's_agg_days_stmt',
            's_agg_uncol_int',
            's_agg_uncol_sc',
            's_agg_uncol_stmt',
            's_atm_nbr_wd',
            's_benf_nbr',
            's_cash_wd_br_nbr',
            's_ckhld_amt',
            's_close_reason',
            's_club_pmt_amt',
            's_coll_hld_amt',
            's_hs_seq',
            's_ib_wd',
            's_keogh_ira_code',
            's_ki_int_dist_cd',
            's_min_bal_code',
            's_min_bal_ltd',
            's_min_dep_code',
            's_naics_code',
            's_nbr_nb',
            's_nbr_wd',
            's_nbr_wd_cyc',
            's_opening_amt',
            's_opening_source',
            's_orig_br',
            's_orig_officer',
            's_otc_tran_ctr',
            's_otc_wd',
            's_own_code',
            's_patm_dep',
            's_patm_inq',
            's_patm_tfr_out',
            's_patm_wd',
            's_penalty_code',
            's_plan_nbr',
            's_pos_nbr_wd',
            's_pos_wd',
            's_preauth_hst_01',
            's_preauth_hst_02',
            's_preauth_hst_03',
            's_preauth_hst_04',
            's_preauth_hst_05',
            's_preauth_hst_06',
            's_preauth_hst_07',
            's_preauth_hst_08',
            's_preauth_hst_09',
            's_preauth_hst_10',
            's_preauth_hst_11',
            's_preauth_hst_12',
            's_preauth_tfr',
            's_prev_sc_avgbal_01',
            's_prev_sc_avgbal_02',
            's_prev_sc_avgbal_03',
            's_prev_sc_avgbal_04',
            's_prev_sc_avgbal_05',
            's_prev_sc_avgbal_06',
            's_prev_sc_avgbal_07',
            's_prev_sc_avgbal_08',
            's_prev_sc_avgbal_09',
            's_prev_sc_avgbal_10',
            's_prev_sc_avgbal_11',
            's_prev_sc_avgbal_12',
            's_psbk_bal',
            's_rate_index_nbr',
            's_regd_pos',
            's_regd_pos_hst_01',
            's_regd_pos_hst_02',
            's_regd_pos_hst_03',
            's_regd_pos_hst_04',
            's_regd_pos_hst_05',
            's_regd_pos_hst_06',
            's_regd_pos_hst_07',
            's_regd_pos_hst_08',
            's_regd_pos_hst_09',
            's_regd_pos_hst_10',
            's_regd_pos_hst_11',
            's_regd_pos_hst_12',
            's_rel_officer',
            's_renew_acct_type',
            's_renewal_term',
            's_rtn_dpitms_ltd',
            's_satm_inq',
            's_satm_wd',
            's_sc_code',
            's_sor_cd',
            's_stmt_cyc_code',
            's_svc_br',
            's_term',
            's_uncol_amt_3',
            's_user_number_1',
            's_user_number_3',
            's_waive_sc_code',
            's_ytd_yr'
        ], 'int') }},
        {{ cast_data_types([
            's_accrued_thru',
            's_acct_nbr',
            's_affiliate_nbr',
            's_cif_nbr',
            's_exp_number_1',
            's_exp_number_2',
            's_exp_number_3',
            's_exp_number_4',
            's_exp_number_5',
            's_exp_number_6',
            's_memo_info',
            's_retirement_nbr',
            's_stmt_comb_acct',
            's_tfr_acct_nbr',
            's_user_alpha_cd_3',
            's_user_alpha_cd_4',
            's_user_alpha_cd_5'
        ], 'varchar(100)') }}

    from source

)

select * from final
